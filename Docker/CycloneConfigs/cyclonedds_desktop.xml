<CycloneDDS>
  <Domain id="0">

    <General>
      <Interfaces>
        <NetworkInterface name="wlp5s0" priority="default" multicast="default"/>
      </Interfaces>

      <MaxMessageSize>65507B</MaxMessageSize>          <!-- Explicit unit: bytes -->
      <FragmentSize>1472B</FragmentSize>               <!-- Explicit unit: bytes -->
      <AllowMulticast>true</AllowMulticast>
      <EnableMulticastLoopback>false</EnableMulticastLoopback>
      <DontRoute>true</DontRoute>
    </General>

    <Discovery>
      <Peers>
        <Peer address="192.168.123.164"/>  <!-- robot IP -->
        <Peer address="192.168.123.18"/>   <!-- operator desktop IP -->
      </Peers>
      <LeaseDuration>10s</LeaseDuration>
    </Discovery>

    <Internal>
      <HeartbeatInterval min="5ms" max="20ms" minsched="5ms"/>
      <NackDelay>2ms</NackDelay>
      <PreEmptiveAckDelay>2ms</PreEmptiveAckDelay>
      <MultipleReceiveThreads>true</MultipleReceiveThreads>
      <SocketReceiveBufferSize min="10MB"/>
      <Watermarks><WhcHigh>500kB</WhcHigh></Watermarks>
    </Internal>

    <Tracing>
      <Verbosity>warning</Verbosity>
    </Tracing>

    <!-- 1) Define a QoS library/profile that sets best_effort + keep_last(1) -->
    <qos_library name="realsense_override">
      <qos_profile name="be_kl1">
        <datawriter_qos>
          <reliability><kind>BEST_EFFORT_RELIABILITY_QOS</kind></reliability>
          <history>
            <kind>KEEP_LAST_HISTORY_QOS</kind>
            <depth>1</depth>
          </history>
        </datawriter_qos>
        <datareader_qos>
          <reliability><kind>BEST_EFFORT_RELIABILITY_QOS</kind></reliability>
          <history>
            <kind>KEEP_LAST_HISTORY_QOS</kind>
            <depth>1</depth>
          </history>
        </datareader_qos>

        <!-- 2) List each exact topic you want to override -->
        <topic_qos name="/realsense/head/color/image_raw/compressed"/>
        <topic_qos name="/realsense/head/aligned_depth_to_color/image_raw/compressedDepth"/>
        <topic_qos name="/realsense/head/color/camera_info"/>
        <topic_qos name="/realsense/head/depth/color/points"/>

        <topic_qos name="/realsense/left_hand/color/image_raw/compressed"/>
        <topic_qos name="/realsense/left_hand/aligned_depth_to_color/image_raw/compressedDepth"/>
        <topic_qos name="/realsense/left_hand/color/camera_info"/>
        <topic_qos name="/realsense/left_hand/depth/color/points"/>
      </qos_profile>
    </qos_library>

    <!-- 3) Apply that profile to this DomainParticipant -->
    <participant_qos>
      <qos_library_ref>realsense_override</qos_library_ref>
      <qos_profile_ref>be_kl1</qos_profile_ref>
    </participant_qos>

    

  </Domain>
</CycloneDDS>
